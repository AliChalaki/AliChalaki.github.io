<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCNA Master | Ali Chalaki</title>
    <style>
        /* --- GLOBAL VARIABLES --- */
        :root {
            --bg-color: #050505;
            --card-bg: rgba(20, 20, 20, 0.85);
            --text-main: #e0e0e0;
            --accent-color: #00ffcc; /* Cyan */
            --accent-secondary: #0099ff; /* Blue */
            --alert-color: #ff3366; /* Red for Security */
            --cmd-bg: rgba(30, 30, 30, 0.98);
            --cmd-text: #00ff00;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- BACKGROUND ANIMATION LAYER --- */
        #canvas-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* --- HEADER --- */
        header {
            text-align: center;
            padding: 60px 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), rgba(0,0,0,0.4));
            backdrop-filter: blur(4px);
            border-bottom: 3px solid var(--accent-color);
            box-shadow: 0 0 20px rgba(0, 255, 204, 0.3);
            position: relative;
            z-index: 2;
        }
        
        header h1 {
            font-size: 4rem;
            color: var(--accent-color);
            text-shadow: 0 0 15px var(--accent-color);
            margin-bottom: 10px;
        }

        header p {
            color: #aaa;
            letter-spacing: 3px;
            font-size: 1.2rem;
        }

        /* --- MAIN CONTENT --- */
        .container {
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 20px;
            flex-grow: 1; 
            z-index: 2;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }

        .column-box {
            background: var(--card-bg);
            border: 1px solid #333;
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
        }

        .column-title {
            font-size: 2rem;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--accent-secondary);
            padding-bottom: 15px;
            color: #fff;
        }

        /* --- RUNBOOK ITEMS --- */
        .rb-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--accent-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Special Style for Security Items */
        .rb-item.security-item {
            border-left: 5px solid var(--alert-color);
        }
        .rb-item.security-item:hover {
            background: rgba(255, 51, 102, 0.1);
        }
        .rb-item.security-item .btn-mini-run {
            border-color: var(--alert-color);
            color: var(--alert-color);
        }
        .rb-item.security-item:hover .btn-mini-run {
            background: var(--alert-color);
            color: #fff;
        }

        .rb-item:hover {
            background: rgba(0, 255, 204, 0.08);
            transform: translateX(10px);
            box-shadow: -5px 5px 15px rgba(0,0,0,0.3);
        }

        .rb-name { font-weight: bold; font-size: 1.2rem; color: #fff; }
        .rb-desc { font-size: 0.85rem; color: #999; margin-top: 5px; }

        .btn-mini-run {
            background: transparent;
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            padding: 8px 20px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .rb-item:hover .btn-mini-run {
            background: var(--accent-color);
            color: #000;
        }

        /* --- LEARN SECTION --- */
        .learn-topic {
            background: rgba(0, 153, 255, 0.05);
            margin-bottom: 20px;
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(0, 153, 255, 0.2);
            text-align: center;
            transition: 0.3s;
        }

        .learn-topic:hover {
            transform: scale(1.03);
            border-color: var(--accent-secondary);
            box-shadow: 0 0 20px rgba(0, 153, 255, 0.2);
        }

        .learn-btn-main {
            display: inline-block;
            margin-top: 15px;
            padding: 12px 30px;
            background: var(--accent-secondary);
            color: #fff;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* --- FOOTER --- */
        footer {
            position: relative;
            height: 250px;
            background: #000; 
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border-top: 3px solid #222;
            margin-top: 50px;
            z-index: 10; 
        }

        #heart-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .footer-content {
            position: relative;
            z-index: 2;
            text-align: center;
            background: transparent; 
        }

        .footer-text {
            color: #fff;
            font-size: 1.2rem;
            font-weight: 300;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .made-by-btn {
            display: inline-block;
            text-decoration: none;
            padding: 12px 30px;
            color: #fff;
            border: 2px solid var(--accent-color);
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            background: rgba(0, 0, 0, 0.7);
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .made-by-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: 0.5s;
        }

        .made-by-btn:hover {
            background: var(--accent-color);
            color: #000;
            box-shadow: 0 0 30px var(--accent-color);
            transform: scale(1.05);
        }

        .made-by-btn:hover::before {
            left: 100%;
        }

        /* --- MODAL --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(8px);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--cmd-bg);
            width: 85%;
            max-width: 900px;
            height: 80vh;
            border-radius: 10px;
            border: 1px solid #444;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 60px rgba(0, 255, 204, 0.15);
            font-family: 'Courier New', Courier, monospace;
        }

        .modal-header {
            background: #1a1a1a;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            color: #fff;
            border-radius: 10px 10px 0 0;
        }

        .modal-header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .close-btn { color: #888; font-size: 30px; cursor: pointer; transition:0.2s; }
        .close-btn:hover { color: #ff4444; }

        .skip-btn {
            background: transparent;
            border: 1px solid #ffcc00;
            color: #ffcc00;
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
            font-weight: bold;
        }
        .skip-btn:hover {
            background: #ffcc00;
            color: #000;
        }

        .cmd-body {
            flex-grow: 1;
            padding: 25px;
            overflow-y: auto;
            color: var(--cmd-text);
            font-size: 1.1rem;
        }

        .cmd-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.03);
            transition: 0.2s;
        }
        .cmd-line:hover { background: rgba(255,255,255,0.02); }

        .cmd-text-container { flex-grow: 1; white-space: pre-wrap; margin-right: 15px; }

        .copy-btn-line {
            background: #222;
            color: #aaa;
            border: 1px solid #444;
            padding: 6px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            border-radius: 4px;
            min-width: 70px;
            transition: 0.2s;
        }
        .copy-btn-line:hover {
            background: var(--accent-color);
            color: #000;
            border-color: var(--accent-color);
        }

        .cursor {
            display: inline-block;
            width: 10px;
            height: 20px;
            background-color: var(--cmd-text);
            animation: blink 1s infinite;
            vertical-align: sub;
        }
        @keyframes blink { 50% { opacity: 0; } }

        @media (max-width: 900px) {
            .dashboard-grid { grid-template-columns: 1fr; }
            header h1 { font-size: 2.5rem; }
            .container { margin: 20px auto; }
        }
    </style>
</head>
<body>

    <div id="canvas-bg"></div>

    <header>
        <h1>CCNA MASTER</h1>
        <p>NETWORK AUTOMATION TOOLKIT</p>
    </header>

    <div class="container">
        <div class="dashboard-grid">
            
            <div class="column-box">
                <div class="column-title">Runbooks <span style="font-size:0.6em; color:#666;">// CMD Ready</span></div>
                
                <div class="rb-item" onclick="openRunbook('router_init')">
                    <div>
                        <div class="rb-name">Router Basic Setup</div>
                        <div class="rb-desc">Interface, IP, No Shut, Verify</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item" onclick="openRunbook('switch_init')">
                    <div>
                        <div class="rb-name">Switch Basic Setup</div>
                        <div class="rb-desc">Hostname, Clock, Management</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item security-item" onclick="openRunbook('user_privileges')">
                    <div>
                        <div class="rb-name">User Access & Privileges</div>
                        <div class="rb-desc">Levels: 15, 0, 5, 7</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item security-item" onclick="openRunbook('router_hardening')">
                    <div>
                        <div class="rb-name">Router Hardening</div>
                        <div class="rb-desc">Login Block, Service Off, Timeouts</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item security-item" onclick="openRunbook('switch_security')">
                    <div>
                        <div class="rb-name">Switch Security</div>
                        <div class="rb-desc">Port Security, DHCP Snooping</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item" onclick="openRunbook('vlaning')">
                    <div>
                        <div class="rb-name">VLAN & Access</div>
                        <div class="rb-desc">L2 Segmentation & Port Assign</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item" onclick="openRunbook('trunking')">
                    <div>
                        <div class="rb-name">Trunking (802.1Q)</div>
                        <div class="rb-desc">Uplinks & Allowed VLANs</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item" onclick="openRunbook('ospf')">
                    <div>
                        <div class="rb-name">OSPF Config</div>
                        <div class="rb-desc">Single Area OSPF Process</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item" onclick="openRunbook('save_backup')">
                    <div>
                        <div class="rb-name">Backups (TFTP / FTP)</div>
                        <div class="rb-desc">NVRAM Save & Remote Backups</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

                <div class="rb-item" onclick="openRunbook('factory_reset')">
                    <div>
                        <div class="rb-name">Factory Reset</div>
                        <div class="rb-desc">Write Erase, Delete Flash</div>
                    </div>
                    <button class="btn-mini-run">RUN</button>
                </div>

            </div>

            <div class="column-box">
                <div class="column-title">Learning Hub <span style="font-size:0.6em; color:#666;">// Visuals</span></div>

                <div class="learn-topic">
                    <h3 style="color:#fff; margin-bottom:10px;">Subnetting & VLSM</h3>
                    <p style="color:#aaa; font-size:0.9rem;">Master binary math and variable length subnet masking with interactive charts.</p>
                    <a href="#" class="learn-btn-main">Start Module</a>
                </div>

                <div class="learn-topic">
                    <h3 style="color:#fff; margin-bottom:10px;">Spanning Tree (STP)</h3>
                    <p style="color:#aaa; font-size:0.9rem;">Understand Root Bridge election and port states visualizer.</p>
                    <a href="#" class="learn-btn-main">Start Module</a>
                </div>

                <div class="learn-topic">
                    <h3 style="color:#fff; margin-bottom:10px;">ACL & Security</h3>
                    <p style="color:#aaa; font-size:0.9rem;">Standard vs Extended Access Control Lists simulator.</p>
                    <a href="#" class="learn-btn-main">Start Module</a>
                </div>
            </div>

        </div>
    </div>

    <footer>
        <canvas id="heart-canvas"></canvas>
        <div class="footer-content">
            <div class="footer-text">
                <span>Made with <span style="color:#ff3366; font-size:1.5rem;">♥</span> for Network Engineers</span>
                <a href="https://alichalaki.github.io/" target="_blank" class="made-by-btn">Ali Chalaki</a>
            </div>
        </div>
    </footer>

    <div id="cmdModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-left">
                    <span id="modal-title" style="font-family:'Courier New'; font-weight:bold;">TERMINAL</span>
                    <button class="skip-btn" onclick="skipAnim()">⚡ SKIP</button>
                </div>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="cmd-body" id="cmd-output">
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // 1. REPTILE ANIMATION
        // ==========================================
        (function() {
            var Input = {
                keys: [],
                mouse: { left: false, right: false, middle: false, x: 0, y: 0 }
            };
            for (var i = 0; i < 230; i++) Input.keys.push(false);
            
            document.addEventListener("keydown", function(event) { Input.keys[event.keyCode] = true; });
            document.addEventListener("keyup", function(event) { Input.keys[event.keyCode] = false; });
            
            document.addEventListener("mousemove", function(event) {
                Input.mouse.x = event.clientX;
                var footer = document.querySelector('footer');
                var footerRect = footer.getBoundingClientRect();
                
                if (event.clientY > footerRect.top) {
                    Input.mouse.y = footerRect.top - 20; 
                } else {
                    Input.mouse.y = event.clientY;
                }
            });

            var container = document.getElementById("canvas-bg");
            var canvas = document.createElement("canvas");
            container.appendChild(canvas);
            var ctx = canvas.getContext("2d");

            function resize() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            window.addEventListener('resize', resize);
            resize();

            var segmentCount = 0;
            class Segment {
                constructor(parent, size, angle, range, stiffness) {
                    segmentCount++; this.isSegment = true; this.parent = parent;
                    if (typeof parent.children == "object") parent.children.push(this);
                    this.children = []; this.size = size; this.relAngle = angle; this.defAngle = angle;
                    this.absAngle = parent.absAngle + angle; this.range = range; this.stiffness = stiffness;
                    this.updateRelative(false, true);
                }
                updateRelative(iter, flex) {
                    this.relAngle = this.relAngle - 2 * Math.PI * Math.floor((this.relAngle - this.defAngle) / 2 / Math.PI + 1 / 2);
                    if (flex) {
                        this.relAngle = Math.min(this.defAngle + this.range / 2, Math.max(this.defAngle - this.range / 2, (this.relAngle - this.defAngle) / this.stiffness + this.defAngle));
                    }
                    this.absAngle = this.parent.absAngle + this.relAngle;
                    this.x = this.parent.x + Math.cos(this.absAngle) * this.size;
                    this.y = this.parent.y + Math.sin(this.absAngle) * this.size;
                    if (iter) for (var i = 0; i < this.children.length; i++) this.children[i].updateRelative(iter, flex);
                }
                draw(iter) {
                    ctx.beginPath(); ctx.moveTo(this.parent.x, this.parent.y); ctx.lineTo(this.x, this.y); ctx.stroke();
                    if (iter) for (var i = 0; i < this.children.length; i++) this.children[i].draw(true);
                }
                follow(iter) {
                    var x = this.parent.x; var y = this.parent.y;
                    var dist = ((this.x - x) ** 2 + (this.y - y) ** 2) ** 0.5;
                    this.x = x + this.size * (this.x - x) / dist;
                    this.y = y + this.size * (this.y - y) / dist;
                    this.absAngle = Math.atan2(this.y - y, this.x - x);
                    this.relAngle = this.absAngle - this.parent.absAngle;
                    this.updateRelative(false, true);
                    if (iter) for (var i = 0; i < this.children.length; i++) this.children[i].follow(true);
                }
            }
            
            class Creature {
                constructor(x, y, angle, fAccel, fFric, fRes, fThresh, rAccel, rFric, rRes, rThresh) {
                    this.x = x; this.y = y; this.absAngle = angle;
                    this.fSpeed = 0; this.fAccel = fAccel; this.fFric = fFric; this.fRes = fRes; this.fThresh = fThresh;
                    this.rSpeed = 0; this.rAccel = rAccel; this.rFric = rFric; this.rRes = rRes; this.rThresh = rThresh;
                    this.children = []; this.systems = [];
                }
                follow(x, y) {
                    var dist = ((this.x - x) ** 2 + (this.y - y) ** 2) ** 0.5;
                    var angle = Math.atan2(y - this.y, x - this.x);
                    
                    var accel = this.fAccel;
                    if (this.systems.length > 0) {
                        var sum = 0; for (var i = 0; i < this.systems.length; i++) sum += this.systems[i].step == 0;
                        accel *= sum / this.systems.length;
                    }
                    this.fSpeed += accel * (dist > this.fThresh);
                    this.fSpeed *= 1 - this.fRes;
                    this.speed = Math.max(0, this.fSpeed - this.fFric);
                    
                    var dif = this.absAngle - angle; dif -= 2 * Math.PI * Math.floor(dif / (2 * Math.PI) + 1 / 2);
                    if (Math.abs(dif) > this.rThresh && dist > this.fThresh) this.rSpeed -= this.rAccel * (2 * (dif > 0) - 1);
                    this.rSpeed *= 1 - this.rRes;
                    if (Math.abs(this.rSpeed) > this.rFric) this.rSpeed -= this.rFric * (2 * (this.rSpeed > 0) - 1); else this.rSpeed = 0;
                    
                    this.absAngle += this.rSpeed; this.absAngle -= 2 * Math.PI * Math.floor(this.absAngle / (2 * Math.PI) + 1 / 2);
                    this.x += this.speed * Math.cos(this.absAngle); this.y += this.speed * Math.sin(this.absAngle);
                    this.absAngle += Math.PI;
                    for (var i = 0; i < this.children.length; i++) this.children[i].follow(true, true);
                    for (var i = 0; i < this.systems.length; i++) this.systems[i].update(x, y);
                    this.absAngle -= Math.PI; this.draw(true);
                }
                draw(iter) {
                    var r = 4; ctx.beginPath(); ctx.arc(this.x, this.y, r, Math.PI / 4 + this.absAngle, 7 * Math.PI / 4 + this.absAngle); ctx.stroke();
                    if (iter) for (var i = 0; i < this.children.length; i++) this.children[i].draw(true);
                }
            }

            class LimbSystem {
                constructor(end, length, speed, creature) {
                    this.end = end; this.length = Math.max(1, length); this.creature = creature; this.speed = speed;
                    creature.systems.push(this); this.nodes = []; var node = end;
                    for (var i = 0; i < length; i++) { this.nodes.unshift(node); node = node.parent; if (!node.isSegment) { this.length = i + 1; break; } }
                    this.hip = this.nodes[0].parent;
                }
                moveTo(x, y) {
                    this.nodes[0].updateRelative(true, true);
                    var dist = ((x - this.end.x) ** 2 + (y - this.end.y) ** 2) ** 0.5; var len = Math.max(0, dist - this.speed);
                    for (var i = this.nodes.length - 1; i >= 0; i--) {
                        var node = this.nodes[i]; var ang = Math.atan2(node.y - y, node.x - x);
                        node.x = x + len * Math.cos(ang); node.y = y + len * Math.sin(ang); x = node.x; y = node.y; len = node.size;
                    }
                    for (var i = 0; i < this.nodes.length; i++) {
                        var node = this.nodes[i]; node.absAngle = Math.atan2(node.y - node.parent.y, node.x - node.parent.x);
                        node.relAngle = node.absAngle - node.parent.absAngle;
                        for (var ii = 0; ii < node.children.length; ii++) { var childNode = node.children[ii]; if (!this.nodes.includes(childNode)) childNode.updateRelative(true, false); }
                    }
                }
                update(x, y) { this.moveTo(x, y); }
            }
            class LegSystem extends LimbSystem {
                constructor(end, length, speed, creature) {
                    super(end, length, speed, creature);
                    this.goalX = end.x; this.goalY = end.y; this.step = 0; this.forwardness = 0;
                    this.reach = 0.9 * ((this.end.x - this.hip.x) ** 2 + (this.end.y - this.hip.y) ** 2) ** 0.5;
                    var relAngle = this.creature.absAngle - Math.atan2(this.end.y - this.hip.y, this.end.x - this.hip.x);
                    relAngle -= 2 * Math.PI * Math.floor(relAngle / 2 / Math.PI + 1 / 2);
                    this.swing = -relAngle + (2 * (relAngle < 0) - 1) * Math.PI / 2;
                    this.swingOffset = this.creature.absAngle - this.hip.absAngle;
                }
                update(x, y) {
                    this.moveTo(this.goalX, this.goalY);
                    if (this.step == 0) {
                        var dist = ((this.end.x - this.goalX) ** 2 + (this.end.y - this.goalY) ** 2) ** 0.5;
                        if (dist > 1) {
                            this.step = 1;
                            this.goalX = this.hip.x + this.reach * Math.cos(this.swing + this.hip.absAngle + this.swingOffset) + (2 * Math.random() - 1) * this.reach / 2;
                            this.goalY = this.hip.y + this.reach * Math.sin(this.swing + this.hip.absAngle + this.swingOffset) + (2 * Math.random() - 1) * this.reach / 2;
                        }
                    } else if (this.step == 1) {
                        var theta = Math.atan2(this.end.y - this.hip.y, this.end.x - this.hip.x) - this.hip.absAngle;
                        var dist = ((this.end.x - this.hip.x) ** 2 + (this.end.y - this.hip.y) ** 2) ** 0.5;
                        var forwardness2 = dist * Math.cos(theta); var dF = this.forwardness - forwardness2; this.forwardness = forwardness2;
                        if (dF * dF < 1) { this.step = 0; this.goalX = this.hip.x + (this.end.x - this.hip.x); this.goalY = this.hip.y + (this.end.y - this.hip.y); }
                    }
                }
            }

            var critter;
            function setupLizard(size, legs, tail) {
                var s = size;
                critter = new Creature(window.innerWidth/2, window.innerHeight/2, 0, s*10, s*1.5, 0.5, 16, 0.5, 0.04, 0.5, 0.3);
                var spinal = critter;
                for (var i=0; i<6; i++) { spinal = new Segment(spinal, s*4, 0, 3.1415*2/3, 1.1); for (var ii=-1; ii<=1; ii+=2) { var node=new Segment(spinal, s*3, ii, 0.1, 2); for (var iii=0; iii<3; iii++) node=new Segment(node, s*0.1, -ii*0.1, 0.1, 2); } }
                for (var i=0; i<legs; i++) { if(i>0){ for(var ii=0; ii<6; ii++){ spinal=new Segment(spinal,s*4,0,1.571,1.5); for(var iii=-1; iii<=1; iii+=2){ var node=new Segment(spinal,s*3,iii*1.571,0.1,1.5); for(var iv=0; iv<3; iv++) node=new Segment(node,s*3,-iii*0.3,0.1,2); } } } for(var ii=-1; ii<=1; ii+=2){ var node=new Segment(spinal,s*12,ii*0.785,0,8); node=new Segment(node,s*16,-ii*0.785,6.28,1); node=new Segment(node,s*16,ii*1.571,3.1415,2); for(var iii=0; iii<4; iii++) new Segment(node,s*4,(iii/3-0.5)*1.571,0.1,4); new LegSystem(node,3,s*12,critter,4); } }
                for (var i=0; i<tail; i++) { spinal = new Segment(spinal, s*4, 0, 3.1415*2/3, 1.1); for (var ii=-1; ii<=1; ii+=2) { var node=new Segment(spinal, s*3, ii, 0.1, 2); for (var iii=0; iii<3; iii++) node=new Segment(node, s*3*(tail-i)/tail, -ii*0.1, 0.1, 2); } }
                
                setInterval(function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    critter.follow(Input.mouse.x, Input.mouse.y);
                }, 33);
            }

            ctx.strokeStyle = "rgba(0, 255, 204, 0.4)"; 
            var legNum = Math.floor(1 + Math.random() * 12);
            setupLizard(8 / Math.sqrt(legNum), legNum, Math.floor(4 + Math.random() * legNum * 8));
        })();

        // ==========================================
        // 2. HEART ANIMATION (Footer Only)
        // ==========================================
        (function() {
            var footerCanvas = document.getElementById('heart-canvas');
            if(!footerCanvas) return;
            
            var ctx = footerCanvas.getContext('2d');
            var footer = document.querySelector('footer');
            var width, height;

            function resizeHeart() {
                width = footerCanvas.width = footer.offsetWidth;
                height = footerCanvas.height = footer.offsetHeight;
            }
            window.addEventListener('resize', resizeHeart);
            resizeHeart();

            var rand = Math.random;
            var heartPosition = function (rad) {
                return [Math.pow(Math.sin(rad), 3), -(15 * Math.cos(rad) - 5 * Math.cos(2 * rad) - 2 * Math.cos(3 * rad) - Math.cos(4 * rad))];
            };
            var scaleAndTranslate = function (pos, sx, sy, dx, dy) {
                return [dx + pos[0] * sx, dy + pos[1] * sy];
            };

            var pointsOrigin = [];
            var traceCount = 30; 
            var dr = 0.1;
            for (var i = 0; i < Math.PI * 2; i += dr) pointsOrigin.push(scaleAndTranslate(heartPosition(i), 110, 6, 0, 0)); 
            for (var i = 0; i < Math.PI * 2; i += dr) pointsOrigin.push(scaleAndTranslate(heartPosition(i), 80, 4, 0, 0));
            for (var i = 0; i < Math.PI * 2; i += dr) pointsOrigin.push(scaleAndTranslate(heartPosition(i), 50, 2, 0, 0));
            var heartPointsCount = pointsOrigin.length;

            var targetPoints = [];
            var pulse = function (kx, ky) {
                for (var i = 0; i < pointsOrigin.length; i++) {
                    targetPoints[i] = [];
                    targetPoints[i][0] = kx * pointsOrigin[i][0] + width / 2;
                    targetPoints[i][1] = ky * pointsOrigin[i][1] + height / 2;
                }
            };

            var e = [];
            for (var i = 0; i < heartPointsCount; i++) {
                var x = rand() * width;
                var y = rand() * height;
                e[i] = {
                    vx: 0, vy: 0, R: 2, speed: rand() + 5, q: ~~(rand() * heartPointsCount),
                    D: 2 * (i % 2) - 1, force: 0.2 * rand() + 0.7,
                    f: "hsla(0," + ~~(40 * rand() + 100) + "%," + ~~(60 * rand() + 20) + "%,.5)",
                    trace: []
                };
                for (var k = 0; k < traceCount; k++) e[i].trace[k] = {x: x, y: y};
            }

            var config = { traceK: 0.4, timeDelta: 0.01 };
            var time = 0;
            
            var loop = function () {
                var n = -Math.cos(time);
                pulse((1 + n) * .5, (1 + n) * .5);
                time += ((Math.sin(time)) < 0 ? 9 : (n > 0.8) ? .2 : 1) * config.timeDelta;
                
                ctx.fillStyle = "rgba(0,0,0,0.1)"; 
                ctx.fillRect(0, 0, width, height);
                
                for (var i = e.length; i--;) {
                    var u = e[i];
                    var q = targetPoints[u.q];
                    var dx = u.trace[0].x - q[0];
                    var dy = u.trace[0].y - q[1];
                    var length = Math.sqrt(dx * dx + dy * dy);
                    
                    if (10 > length) {
                        if (0.95 < rand()) { u.q = ~~(rand() * heartPointsCount); }
                        else {
                            if (0.99 < rand()) { u.D *= -1; }
                            u.q += u.D; u.q %= heartPointsCount;
                            if (0 > u.q) { u.q += heartPointsCount; }
                        }
                    }
                    u.vx += -dx / length * u.speed;
                    u.vy += -dy / length * u.speed;
                    u.trace[0].x += u.vx; u.trace[0].y += u.vy;
                    u.vx *= u.force; u.vy *= u.force;
                    
                    for (var k = 0; k < u.trace.length - 1;) {
                        var T = u.trace[k]; var N = u.trace[++k];
                        N.x -= config.traceK * (N.x - T.x);
                        N.y -= config.traceK * (N.y - T.y);
                    }
                    ctx.fillStyle = u.f;
                    for (var k = 0; k < u.trace.length; k++) {
                        ctx.fillRect(u.trace[k].x, u.trace[k].y, 1, 1);
                    }
                }
                requestAnimationFrame(loop);
            };
            loop();
        })();

        // ==========================================
        // 3. RUNBOOK LOGIC
        // ==========================================
        const runbooks = {
            'router_init': [
                { prompt: "Router>", cmd: "enable", desc: "Privileged Mode" },
                { prompt: "Router#", cmd: "configure terminal", desc: "Global Config" },
                { prompt: "Router(config)#", cmd: "hostname R1-Gateway", desc: "Identity" },
                { prompt: "R1-Gateway(config)#", cmd: "no ip domain-lookup", desc: "Prevent DNS Delays" },
                { prompt: "R1-Gateway(config)#", cmd: "interface g0/0", desc: "Select Interface" },
                { prompt: "R1-Gateway(config-if)#", cmd: "description WAN Link", desc: "Labeling" },
                { prompt: "R1-Gateway(config-if)#", cmd: "ip address 192.168.1.1 255.255.255.0", desc: "Set IP" },
                { prompt: "R1-Gateway(config-if)#", cmd: "no shutdown", desc: "Power On" },
                { prompt: "R1-Gateway(config-if)#", cmd: "end", desc: "Return to Priv" },
                { prompt: "R1-Gateway#", cmd: "show ip interface brief", desc: "Verify L1/L2" },
                { prompt: "R1-Gateway#", cmd: "show running-config", desc: "Verify All" },
                { prompt: "R1-Gateway#", cmd: "copy running-config startup-config", desc: "Save" }
            ],
            'switch_init': [
                { prompt: "Switch>", cmd: "enable", desc: "Enter Priv Mode" },
                { prompt: "Switch#", cmd: "clock set 12:00:00 23 Dec 2025", desc: "Set Time (Exec)" },
                { prompt: "Switch#", cmd: "configure terminal", desc: "Global Config" },
                { prompt: "Switch(config)#", cmd: "hostname SW-CORE-01", desc: "Set ID" },
                { prompt: "SW-CORE-01(config)#", cmd: "no ip domain-lookup", desc: "Stop DNS" },
                { prompt: "SW-CORE-01(config)#", cmd: "enable secret Cisco123!", desc: "Encrypted PW" },
                { prompt: "SW-CORE-01(config)#", cmd: "service password-encryption", desc: "Encrypt All" },
                { prompt: "SW-CORE-01(config)#", cmd: "line vty 0 4", desc: "SSH Lines" },
                { prompt: "SW-CORE-01(config-line)#", cmd: "transport input ssh", desc: "SSH Only" },
                { prompt: "SW-CORE-01(config-line)#", cmd: "login local", desc: "Local Auth" },
                { prompt: "SW-CORE-01(config-line)#", cmd: "exit", desc: "" },
                { prompt: "SW-CORE-01(config)#", cmd: "crypto key generate rsa", desc: "Gen Keys" }
            ],
            // --- NEW SEPARATE ITEM: User Access & Privileges (Updated to 15, 0, 5, 7) ---
            'user_privileges': [
                // Level 15 (Max)
                { prompt: "Switch(config)#", cmd: "username Admin privilege 15 secret AdminPass", desc: "Full Admin (Lvl 15)" },

                // Level 0 (Min)
                { prompt: "Switch(config)#", cmd: "username Guest privilege 0 secret GuestPass", desc: "Min Access (Lvl 0)" },

                // Level 5 (Custom)
                { prompt: "Switch(config)#", cmd: "username Staff privilege 5 secret StaffPass", desc: "Custom User (Lvl 5)" },
                { prompt: "Switch(config)#", cmd: "privilege exec level 5 ping", desc: "Allow Ping for Lvl 5" },

                // Level 7 (Custom)
                { prompt: "Switch(config)#", cmd: "username Senior privilege 7 secret SeniorPass", desc: "Custom User (Lvl 7)" },
                { prompt: "Switch(config)#", cmd: "privilege exec level 7 show ip interface brief", desc: "Allow Show IP for Lvl 7" },

                // Enabling Login
                { prompt: "Switch(config)#", cmd: "line vty 0 4", desc: "Select Lines" },
                { prompt: "Switch(config-line)#", cmd: "login local", desc: "Activate Users" }
            ],
            // --- NEW: Router Hardening ---
            'router_hardening': [
                { prompt: "R1(config)#", cmd: "service password-encryption", desc: "Hide all passwords" },
                { prompt: "R1(config)#", cmd: "login block-for 60 attempts 3 within 30", desc: "Stop Brute Force" },
                { prompt: "R1(config)#", cmd: "security authentication failure rate 3 log", desc: "Log Failures" },
                { prompt: "R1(config)#", cmd: "ip http server", desc: "Disable HTTP" },
                { prompt: "R1(config)#", cmd: "no ip http secure-server", desc: "Disable HTTPS (if needed)" },
                { prompt: "R1(config)#", cmd: "no service pad", desc: "Disable Pad Service" },
                { prompt: "R1(config)#", cmd: "no ip bootp server", desc: "Disable Bootp" },
                { prompt: "R1(config)#", cmd: "line vty 0 4", desc: "VTY Config" },
                { prompt: "R1(config-line)#", cmd: "exec-timeout 5 0", desc: "Auto Logout (5m)" }
            ],
            // --- NEW: Switch Security (Hardening) ---
            'switch_security': [
                // 1. Unused Ports
                { prompt: "SW1(config)#", cmd: "interface range f0/20 - 24", desc: "Select Unused" },
                { prompt: "SW1(config-if-range)#", cmd: "shutdown", desc: "Turn Off" },
                { prompt: "SW1(config-if-range)#", cmd: "switchport mode access", desc: "Force Access" },
                { prompt: "SW1(config-if-range)#", cmd: "switchport access vlan 999", desc: "Blackhole VLAN" },
                { prompt: "SW1(config-if-range)#", cmd: "exit", desc: "" },
                // 2. DHCP Snooping
                { prompt: "SW1(config)#", cmd: "ip dhcp snooping", desc: "Enable Globally" },
                { prompt: "SW1(config)#", cmd: "ip dhcp snooping vlan 10,20", desc: "For Specific VLANs" },
                { prompt: "SW1(config)#", cmd: "interface g0/1", desc: "Uplink to Router" },
                { prompt: "SW1(config-if-range)#", cmd: "ip dhcp snooping trust", desc: "Trust Uplink" },
                { prompt: "SW1(config-if)#", cmd: "exit", desc: "" },
                // 3. Port Security
                { prompt: "SW1(config)#", cmd: "interface f0/1", desc: "User Port" },
                { prompt: "SW1(config-if)#", cmd: "switchport port-security", desc: "Enable Feature" },
                { prompt: "SW1(config-if)#", cmd: "switchport port-security maximum 2", desc: "Max Devices" },
                { prompt: "SW1(config-if)#", cmd: "switchport port-security violation shutdown", desc: "Kill on Violation" },
                { prompt: "SW1(config-if)#", cmd: "switchport port-security mac-address sticky", desc: "Learn MAC" }
            ],
            'vlaning': [
                { prompt: "SW1(config)#", cmd: "vlan 10", desc: "Create VLAN 10" },
                { prompt: "SW1(config-vlan)#", cmd: "name HR", desc: "Name it HR" },
                { prompt: "SW1(config-vlan)#", cmd: "exit", desc: "" },
                { prompt: "SW1(config)#", cmd: "vlan 20", desc: "Create VLAN 20" },
                { prompt: "SW1(config-vlan)#", cmd: "name IT", desc: "Name it IT" },
                { prompt: "SW1(config-vlan)#", cmd: "exit", desc: "" },
                { prompt: "SW1(config)#", cmd: "interface range f0/1 - 10", desc: "Batch Select" },
                { prompt: "SW1(config-if-range)#", cmd: "switchport mode access", desc: "Access Mode" },
                { prompt: "SW1(config-if-range)#", cmd: "switchport access vlan 10", desc: "Assign HR" }
            ],
            'trunking': [
                { prompt: "SW1(config)#", cmd: "interface g0/1", desc: "Uplink Port" },
                { prompt: "SW1(config-if)#", cmd: "switchport trunk encapsulation dot1q", desc: "Protocol" },
                { prompt: "SW1(config-if)#", cmd: "switchport mode trunk", desc: "Force Trunk" },
                { prompt: "SW1(config-if)#", cmd: "switchport trunk native vlan 99", desc: "Security" },
                { prompt: "SW1(config-if)#", cmd: "switchport trunk allowed vlan 10,20,99", desc: "Filter" }
            ],
            'ospf': [
                { prompt: "R1(config)#", cmd: "router ospf 1", desc: "Process ID 1" },
                { prompt: "R1(config-router)#", cmd: "network 192.168.10.0 0.0.0.255 area 0", desc: "Advertise 10" },
                { prompt: "R1(config-router)#", cmd: "network 10.0.0.0 0.0.0.3 area 0", desc: "Advertise WAN" },
                { prompt: "R1(config-router)#", cmd: "passive-interface g0/1", desc: "Stop Hello" },
                { prompt: "R1(config-router)#", cmd: "end", desc: "" }
            ],
            // --- Save & Backup (TFTP & FTP) ---
            'save_backup': [
                // 1. Local Save
                { prompt: "Switch#", cmd: "copy running-config startup-config", desc: "Save to NVRAM" },
                { prompt: "Destination filename [startup-config]?", cmd: "", desc: "Press Enter" },
                
                // 2. TFTP Backup
                { prompt: "Switch#", cmd: "copy running-config tftp:", desc: "Backup via TFTP" },
                { prompt: "Address or name of remote host []?", cmd: "192.168.1.50", desc: "TFTP Server IP" },
                { prompt: "Destination filename [switch-conf]?", cmd: "sw-backup-tftp", desc: "File Name" },
                
                // 3. FTP Configuration
                { prompt: "Switch#", cmd: "configure terminal", desc: "Config for FTP" },
                { prompt: "Switch(config)#", cmd: "ip ftp username Admin", desc: "Set FTP User" },
                { prompt: "Switch(config)#", cmd: "ip ftp password Cisco123", desc: "Set FTP Pass" },
                { prompt: "Switch(config)#", cmd: "exit", desc: "Exit Config" },

                // 4. FTP Backup
                { prompt: "Switch#", cmd: "copy running-config ftp:", desc: "Backup via FTP" },
                { prompt: "Address or name of remote host []?", cmd: "192.168.1.60", desc: "FTP Server IP" },
                { prompt: "Destination filename [switch-conf]?", cmd: "sw-backup-ftp", desc: "File Name" }
            ],
            // --- Wipe & Reset ---
            'factory_reset': [
                { prompt: "Switch#", cmd: "write erase", desc: "Wipe Startup Config" },
                { prompt: "Erasing the nvram filesystem will remove all configuration files! Continue? [confirm]", cmd: "", desc: "Confirm Erase" },
                { prompt: "Switch#", cmd: "delete flash:vlan.dat", desc: "Remove VLAN DB" },
                { prompt: "Delete filename [vlan.dat]?", cmd: "", desc: "Press Enter" },
                { prompt: "Delete flash:vlan.dat? [confirm]", cmd: "", desc: "Confirm Delete" },
                { prompt: "Switch#", cmd: "reload", desc: "Reboot Switch" },
                { prompt: "Proceed with reload? [confirm]", cmd: "", desc: "Confirm Reboot" }
            ]
        };

        let isSkipping = false;

        function openRunbook(key) {
            const modal = document.getElementById("cmdModal");
            const output = document.getElementById("cmd-output");
            const title = document.getElementById("modal-title");
            
            const data = runbooks[key];
            if(!data) return;

            isSkipping = false; // Reset skip state
            modal.style.display = "flex";
            title.innerText = "TERMINAL > " + key.toUpperCase();
            output.innerHTML = ""; 

            // Initial Cursor
            const cursor = document.createElement("span");
            cursor.className = "cursor";
            output.appendChild(cursor);

            runLineByLine(data, output, cursor);
        }

        function skipAnim() {
            isSkipping = true;
        }

        async function runLineByLine(runbook, container, cursor) {
            for (let i = 0; i < runbook.length; i++) {
                const item = runbook[i];
                
                const lineDiv = document.createElement('div');
                lineDiv.className = 'cmd-line';
                
                const textSpan = document.createElement('span');
                textSpan.className = 'cmd-text-container';
                
                const btn = document.createElement('button');
                btn.className = 'copy-btn-line';
                btn.innerText = "Copy";
                // Only copy the command, not the prompt
                btn.onclick = () => copyText(item.cmd, btn);
                btn.style.opacity = '0'; 

                lineDiv.appendChild(textSpan);
                lineDiv.appendChild(btn);
                
                // Insert before cursor
                container.insertBefore(lineDiv, cursor);

                // Type both prompt and command for visual effect
                await typeWriter(textSpan, item.prompt, item.cmd, item.desc);
                btn.style.opacity = '1'; // Show copy btn immediately
                container.scrollTop = container.scrollHeight;
            }
            
            // End msg
            const endDiv = document.createElement("div");
            endDiv.style.color = "cyan";
            endDiv.style.marginTop = "20px";
            endDiv.innerText = "-- CONFIGURATION END --";
            container.insertBefore(endDiv, cursor);
        }

        async function typeWriter(element, prompt, cmd, desc) {
            let promptHtml = `<span style='color:#888'>${prompt} </span>`;
            
            // --- FAST PATH (SKIP) ---
            if (isSkipping) {
                element.innerHTML = promptHtml + (cmd || "");
                if(desc) element.innerHTML += ` <span style='color:#00aa00; font-style:italic;'>// ${desc}</span>`;
                return; // Return immediately, promise resolves instantly
            }

            // --- SLOW PATH (ANIMATION) ---
            element.innerHTML = promptHtml;
            
            // Type command character by character
            let currentText = "";
            if (cmd) {
                for(let i = 0; i < cmd.length; i++) {
                    if (isSkipping) {
                        // User clicked skip mid-typing
                        element.innerHTML = promptHtml + cmd;
                        break; 
                    }
                    currentText += cmd[i];
                    element.innerHTML = promptHtml + currentText;
                    // SLOW WRITING EFFECT: 50ms per character
                    await new Promise(r => setTimeout(r, 50));
                }
            }

            // Add description if exists
            if(desc) {
                element.innerHTML += ` <span style='color:#00aa00; font-style:italic;'>// ${desc}</span>`;
            }

            // Small pause after line completion (only if not skipping)
            if (!isSkipping) await new Promise(r => setTimeout(r, 300));
        }

        function copyText(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                const orig = btn.innerText;
                btn.innerText = "✓";
                btn.style.color = "#00ff00";
                setTimeout(() => {
                    btn.innerText = orig;
                    btn.style.color = "#aaa";
                }, 1000);
            });
        }

        function closeModal() {
            document.getElementById("cmdModal").style.display = "none";
        }
        
        window.onclick = function(e) {
            if(e.target == document.getElementById("cmdModal")) closeModal();
        }

    </script>
</body>
</html>
